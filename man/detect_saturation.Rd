% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/saturationDetection.r
\name{detect_saturation}
\alias{detect_saturation}
\title{Detect Saturation Point in Sequencing Depth Analysis}
\usage{
detect_saturation(
  data,
  nmi_col = "NMI",
  depth_col = "seq_depth",
  pilot_depth = NULL,
  slope_threshold = 0.05,
  required_NMI_percentage = 0.8,
  plot = TRUE
)
}
\arguments{
\item{data}{A data frame containing sequencing depth and performance metric information.}

\item{nmi_col}{Character string specifying the column name for the performance
metric (e.g., NMI, ARI). Default is "NMI".}

\item{depth_col}{Character string specifying the column name for sequencing depth.
Default is "seq_depth".}

\item{pilot_depth}{Numeric value for pilot sequencing depth. If provided, results
will show absolute sequencing depth (seq_depth * pilot_depth). If NULL (default),
results show relative sequencing depth.}

\item{slope_threshold}{Numeric value defining the slope threshold below which a
point is considered saturated. Default is 0.05.}

\item{required_NMI_percentage}{Numeric value between 0 and 1 indicating the
percentage of maximum NMI that must be achieved before considering saturation.
Default is 0.8 (80\%).}

\item{plot}{Logical indicating whether to generate a plot. Default is TRUE.}
}
\value{
A list with the following components:
\item{saturation_point}{A data frame containing the detected saturation point,
including sequencing depth and predicted NMI value.}
\item{predictions}{A data frame with model predictions across the full range
of sequencing depths.}
\item{model}{The fitted SCAM (Shape Constrained Additive Model) object.}
\item{data}{The input data used for model fitting.}
\item{plot}{A ggplot2 object (if plot = TRUE) showing the data points, fitted
curve, and saturation point.}
}
\description{
This function fits a monotonic spline model to analyze the relationship between
sequencing depth and a performance metric (e.g., NMI), then identifies the saturation
point where further sequencing depth yields diminishing returns.
}
\details{
The function uses Shape Constrained Additive Models (SCAM) to fit a monotonically
increasing spline to the relationship between sequencing depth and performance
metric. Saturation is detected when:
\enumerate{
\item The predicted metric reaches the specified percentage of its maximum value
\item The slope of the curve falls below the specified threshold
}
}
\examples{
\dontrun{
# Basic usage with relative depth
results <- detect_saturation(
  data = my_results,
  slope_threshold = 0.05,
  required_NMI_percentage = 0.8
)

# With absolute depth conversion
results <- detect_saturation(
  data = my_results,
  pilot_depth = 19.3,
  slope_threshold = 0.05,
  required_NMI_percentage = 0.8
)

# Access saturation point
print(results$saturation_point)

# View the plot
results$plot
}

}
