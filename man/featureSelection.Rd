% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/featureSelection.r
\name{featureSelection}
\alias{featureSelection}
\title{Select Domain-Informative Genes for Each Spatial Domain}
\usage{
featureSelection(
  spaDesign,
  logfc_cutoff,
  mean_in_cutoff,
  max_num_gene,
  n_cores
)
}
\arguments{
\item{spaDesign}{A \code{spaDesign} object containing:
\itemize{
\item Count matrix (accessible via \code{refCounts})
\item Spatial coordinates and domain assignments (accessible via \code{refcolData})
}}

\item{logfc_cutoff}{Numeric scalar > 0. Minimum absolute log fold change threshold.
Genes must have |logFC| >= this value to be considered domain-informative.}

\item{mean_in_cutoff}{Numeric scalar > 0. Minimum mean log-transformed expression
required within the domain. Filters out lowly expressed genes.}

\item{max_num_gene}{Integer. Maximum number of genes to select per spatial domain.
If more genes pass the filters, the top \code{max_num_gene} genes with highest
absolute logFC are retained.}

\item{n_cores}{Integer. Number of CPU cores to use for parallel processing across domains.

#' @return A \code{spaDesign} object with the \code{topGenes} slot updated.
The \code{topGenes} slot contains a named list where each element corresponds
to a spatial domain and contains a data frame of selected genes with their
fold change statistics.}
}
\description{
Identifies and selects genes that are highly expressed and differential expressed
within each spatial domain compared to outside the domain. Selected genes are stored
in the \code{topGenes} slot of the \code{spaDesign} object for downstream analysis.
}
\examples{
\dontrun{
# Select domain-informative genes
my_spadesign <- featureSelection(
  spaDesign = my_spadesign,
  logfc_cutoff = 0.7,      # Require at least 0.7 log FC
  mean_in_cutoff = 2,       # Require mean log-expression >= 2 in domain
  max_num_gene = 50,        # Select maximum 50 genes per domain
  n_cores = 4
)

# Access the selected genes for each domain
top_genes <- my_spadesign@topGenes

# View genes for first domain
head(top_genes[[1]])
}
}
